steps:
  STG_LINEITEM_ORDERS_DIM_LOOKUP-4d64acab-9d4a-43e5-a0c2-07c3bf0acff1:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isDataVault: false
      isMultisource: false
      locationName: WORK
      materializationType: table
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: e3ab92b2-2ca4-42b7-8aa5-9811042385b5
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER
            description: ""
            name: DIM_CUSTOMER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 14db2a8f-2bad-4e55-8b96-570972d7f094
                    stepCounter: b34c9ebc-82ad-42af-a814-8096c7edee99
                transform: ""
          - columnReference:
              columnCounter: 5762f924-ecfd-4a19-a5d1-313ba8ddd961
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER
            description: ""
            name: DIM_PART_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 484e38bd-ca91-4126-83a8-fc048027d7d6
                    stepCounter: 7d96dfaa-5cef-4946-a260-8280dc2362b4
                transform: ""
          - columnReference:
              columnCounter: a042d698-45bd-45c3-98b8-99a707c58814
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER
            description: ""
            name: DIM_SUPPLIER_KEY
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c5592a31-a2bb-48d7-9b70-58fe8351d628
                    stepCounter: 3271df10-55e2-46a2-8bc1-51d41e6aa6ed
                transform: ""
          - columnReference:
              columnCounter: 6c3f4e2f-7d98-4722-befa-696f3634b61a
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CUSTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b538786b-4c73-40be-975b-38ff2d2840df
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 15cf784b-9b7a-4079-9875-73036e46a56d
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SUPPKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: f1069ad5-d2a8-487f-979c-90e0237fffd0
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 94624aff-5c77-4ab5-afcf-5df4bb23fa01
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_PARTKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 465ffeb5-98bb-4b91-ae26-36728834ec75
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 6b7e1b57-2b69-4d34-a101-0cdbd1a7c8b9
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 70674be6-b9b4-49bb-bd6d-dd7ae3d444e9
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: f77012f0-1804-4859-afec-ec5d1c0d09f1
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINENUMBER
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a6930594-a3f2-455d-b347-71b85576aba9
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 096bbfb4-1ce8-499a-96f2-ccf701bdeda0
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_QUANTITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e816dfeb-c96c-4b7b-a4d8-aa5cb212cd54
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: f707d219-c2e0-408b-a6dc-9c348c664469
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_EXTENDEDPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e0636d38-b7f6-454f-b18c-cfb876f3a88f
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 1b05ba0b-be07-4e0e-9817-1ed83f99a286
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_DISCOUNT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ed02a34c-9dfe-4e3c-8e41-136505e90142
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 4a30f50f-c914-48f5-bd37-d38187378b62
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_TAX
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bbbf9d00-9eaf-4970-99e0-f576b73f0be9
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: d1e090cf-0cc9-46ec-943e-0ac55949762d
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RETURNFLAG
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b99ff2d6-79af-4472-9343-e1f18df6dfa2
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 12143ecf-5ca9-46e0-a821-8e0c37b2f293
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_LINESTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c91d9b2d-a227-475f-98d2-efc1f66dbe90
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 1144e3ab-2fec-4b86-b0e3-13df40e38850
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: dda5d0c6-0505-4d44-9906-fd631c1ddbcc
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: bae8fcd7-e719-4cd8-ba40-f9094319c388
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMITDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 91166a57-b86c-4621-be7d-2b2d372141f1
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 9ccb4990-99fc-4702-813a-dfa3aa65ad7c
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_RECEIPTDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 55afa214-0c03-4183-a301-6abf85ec9d28
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: f56d5d8c-655b-42c2-b81d-c3efb4aca8f5
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(25)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPINSTRUCT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b8ca8fad-736f-4226-9027-575ba84795f6
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 1f687564-7698-4fee-99d4-e8bea9bf0184
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(10)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_SHIPMODE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6fa312e0-4824-42b0-bbf9-0636ac58f69a
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 00e74cde-73fa-459a-af58-37805675b1c5
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(44)
            description: ""
            hashColumns: []
            hashDetails: null
            name: L_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 95bd65ee-d85c-40e0-ae3c-337298449c41
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: ea3e3a36-81b7-42d9-a751-4c97149236cc
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERKEY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 6fe988c5-5c7d-4f79-ba2c-bd1a55d3d6b0
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: b8ffc463-c079-46c7-bee3-9689c4414fcc
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(1)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERSTATUS
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: b3e8ab7d-2b09-4450-b0de-87d1d35078b6
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: a6b8ce43-cdf7-4a53-9eb9-e351e5a5a2a3
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(12,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_TOTALPRICE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: efbc24cf-a1e0-49eb-9ad1-bdea93339950
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: d06442f6-db0c-4307-b7fa-3958f12c031f
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: DATE
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERDATE
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d2f31df4-d5f4-4af5-b13e-3adc29dbb1a7
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 027fcd4b-7dd0-468c-a878-402be46e3308
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_NUM
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: bf537b75-1507-4e53-86a7-4d3ef97ba6dc
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: ec2b6db5-f6fc-4c18-9a84-a85b2a223d8f
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_ORDERPRIORITY_DESC
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 41fd0152-34cd-423e-9f05-71031dddca18
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 287530be-510d-4417-a009-44515d1aec9f
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(15)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_CLERK
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d55ba4e0-0527-4f15-bda1-9220efc8e89e
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: e681f199-98bf-47b0-a79a-fcba01ff0053
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_SHIPPRIORITY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ccad0dfa-2957-40f1-9670-bf0d31752a20
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: f92bb5fd-7c0b-49c9-8c6a-72368fa9d4c0
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: VARCHAR(79)
            description: ""
            hashColumns: []
            hashDetails: null
            name: O_COMMENT
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 8855ed3d-2484-4c63-aced-2650b1ba44ac
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - columnReference:
              columnCounter: 0873505d-ddd1-4084-b49e-e3f64914b909
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER
            description: ""
            hashColumns: []
            hashDetails: null
            name: DAYS TO SHIP
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: ddad247a-cef2-42fd-aa41-f3d54c6c09f5
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 1e9fc347-103f-49bd-8866-d7df835a37f4
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(38,0)
            description: ""
            name: PS_AVAILQTY
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 01855449-365c-43d5-acef-b0b9c57cdcdd
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
          - acceptedValues:
              strictMatch: false
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 00624d1f-afe4-4f6f-ade4-b4d6182d9224
              stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
            dataType: NUMBER(12,2)
            description: ""
            name: PS_SUPPLYCOST
            nullable: false
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 2f788509-549c-4a9b-b318-194ee952a7a9
                    stepCounter: a0ebc525-7405-4556-b75b-77e97e79acce
                transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              DIM_CUSTOMER: b34c9ebc-82ad-42af-a814-8096c7edee99
              DIM_PART: 7d96dfaa-5cef-4946-a260-8280dc2362b4
              DIM_SUPPLIER: 3271df10-55e2-46a2-8bc1-51d41e6aa6ed
              STG_LINEITEM_ORDERS: a0ebc525-7405-4556-b75b-77e97e79acce
              STG_PARTSUPP: 1039f027-af06-4ca8-8c8a-e1149de561e6
            customSQL:
              customSQL: ""
            dependencies:
              - locationName: WORK
                nodeName: DIM_CUSTOMER
              - locationName: WORK
                nodeName: DIM_PART
              - locationName: WORK
                nodeName: DIM_SUPPLIER
              - locationName: WORK
                nodeName: STG_LINEITEM_ORDERS
              - locationName: WORK
                nodeName: STG_PARTSUPP
            join:
              joinCondition: |
                FROM {{ ref('WORK', 'STG_LINEITEM_ORDERS') }} "STG_LINEITEM_ORDERS"
                LEFT JOIN {{ ref('WORK', 'DIM_CUSTOMER') }} "DIM_CUSTOMER"
                ON "STG_LINEITEM_ORDERS"."O_CUSTKEY" = "DIM_CUSTOMER"."C_CUSTKEY"
                AND "STG_LINEITEM_ORDERS"."O_ORDERDATE" BETWEEN "DIM_CUSTOMER"."SYSTEM_START_DATE" AND "DIM_CUSTOMER"."SYSTEM_END_DATE"
                /* The dimension lookup will not yield any matches due to a lack of historical data in the customer dimension. */
                LEFT JOIN {{ ref('WORK', 'DIM_PART') }} "DIM_PART"
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "DIM_PART"."P_PARTKEY"
                LEFT JOIN {{ ref('WORK', 'DIM_SUPPLIER') }} "DIM_SUPPLIER"
                ON "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "DIM_SUPPLIER"."S_SUPPKEY"
                LEFT JOIN {{ ref('WORK', 'STG_PARTSUPP') }} "STG_PARTSUPP"
                ON "STG_LINEITEM_ORDERS"."L_PARTKEY" = "STG_PARTSUPP"."PS_PARTKEY" AND
                "STG_LINEITEM_ORDERS"."L_SUPPKEY" = "STG_PARTSUPP"."PS_SUPPKEY"
            name: STG_LINEITEM_ORDERS_DIM_LOOKUP
            noLinkRefs: []
      name: STG_LINEITEM_ORDERS_DIM_LOOKUP
      overrideSQL: false
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 4d64acab-9d4a-43e5-a0c2-07c3bf0acff1
